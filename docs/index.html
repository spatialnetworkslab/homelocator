<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inferring Home Locations for Social Media Users  • homelocator</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Inferring Home Locations for Social Media Users ">
<meta property="og:description" content="Inferring users' potential home(s) based on location and timestampe information from social media data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">homelocator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/homelocator.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/spatialnetworkslab/homelocator/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="homelocator" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#homelocator" class="anchor"></a>homelocator</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The goal of <code>homelocator</code> is to provide a consistent framework and interface for the adoption of different approaches for identifying meaningful locations for users. With the package, you are able to write structured, algorithmic ‘recipes’ to identify meaningful locations according to your research requirements. The package also has a number of built-in ‘recipes’ that have been translated from approaches in the existing literature.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of homelocator from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"homelocator"</span>)</pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"spatialnetworkslab/homelocator"</span>)</pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>These are some basic examples that show you how to use common functions in the package.</p>
<div id="validate-input-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#validate-input-dataset" class="anchor"></a>Validate input dataset</h3>
<p>You need to make sure the input dataset includes three essential attributes:</p>
<ul>
<li>a unique identifier for the person or user</li>
<li>a unique identifier for the spatial locaiton for the data point</li>
<li>a timestamp that relects the time the data point was created</li>
</ul>
<p>You can use <code><a href="reference/validate_dataset.html">validate_dataset()</a></code> to validate your input dataset before starting identifying meaningful locations. In this function, you need to specify the names of three essential attribute that used in your dataset.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">homelocator</span>)
<span class="no">test_sample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="fu">here</span>(<span class="st">"data/test_sample.rds"</span>))
<span class="no">df_validated</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/validate_dataset.html">validate_dataset</a></span>(<span class="no">test_sample</span>,
                 <span class="kw">user</span> <span class="kw">=</span> <span class="st">"u_id"</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>, <span class="kw">location</span> <span class="kw">=</span> <span class="st">"grid_id"</span>)
<span class="co">#&gt; 🎉 Congratulations!! Your dataset has passed validation.</span>
<span class="co">#&gt; 👤 There are 3000 unique users in your dataset.</span>
<span class="co">#&gt; 🌏 Now start your journey identifying their meaningful location(s)!</span>
<span class="co">#&gt; 👏 Good luck!</span>
<span class="co">#&gt; </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_validated</span>)
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   u_id     grid_id created_at         </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt; &lt;dttm&gt;             </span>
<span class="co">#&gt; 1 26295661     566 2013-03-05 22:03:15</span>
<span class="co">#&gt; 2 69400017    1012 2013-06-11 14:12:45</span>
<span class="co">#&gt; 3 16294855    1188 2013-04-30 18:47:58</span>
<span class="co">#&gt; 4 40275983     254 2014-02-15 16:14:01</span>
<span class="co">#&gt; 5 91759535    1233 2014-03-05 14:57:07</span>
<span class="co">#&gt; 6 81298067    1296 2015-04-22 05:30:41</span></pre></div>
</div>
<div id="nesting-users-for-parallel-computing" class="section level3">
<h3 class="hasAnchor">
<a href="#nesting-users-for-parallel-computing" class="anchor"></a>Nesting users for parallel computing</h3>
<p>To speed up computing progress, you can nest the validated dataset by user so that the subsequent location inference can be applied to each user at the same time.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">df_nested</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/nest_verbose.html">nest_verbose</a></span>(<span class="no">df_validated</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"created_at"</span>, <span class="st">"grid_id"</span>))
<span class="co">#&gt; 🛠 Start nesting...</span>
<span class="co">#&gt; ✅ Finish nesting!</span>
<span class="co">#&gt; ⌛ Nesting time: 0.01 mins</span>
<span class="co">#&gt; </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_nested</span>)
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   u_id     data                </span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;list&gt;              </span>
<span class="co">#&gt; 1 26295661 &lt;tibble [406 × 2]&gt;  </span>
<span class="co">#&gt; 2 69400017 &lt;tibble [79 × 2]&gt;   </span>
<span class="co">#&gt; 3 16294855 &lt;tibble [5,889 × 2]&gt;</span>
<span class="co">#&gt; 4 40275983 &lt;tibble [67 × 2]&gt;   </span>
<span class="co">#&gt; 5 91759535 &lt;tibble [1,823 × 2]&gt;</span>
<span class="co">#&gt; 6 81298067 &lt;tibble [191 × 2]&gt;</span></pre></div>
</div>
<div id="enrich-variables-from-timestamp" class="section level3">
<h3 class="hasAnchor">
<a href="#enrich-variables-from-timestamp" class="anchor"></a>Enrich variables from timestamp</h3>
<p>Add additional needed varialbes derived from the timestamp column. These are often used/needed as intermediate variables in home location algorithms, such as year, month, day, day of the week and hour of the day, etc.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="reference/enrich_timestamp.html">enrich_timestamp</a></span>(<span class="no">df_nested</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>)
<span class="co">#&gt; 🛠 Enriching variables from timestamp...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ✅ Finish enriching! New added variables: year, month, day, wday, hour, ymd.</span>
<span class="co">#&gt; ⌛ Enriching time: 0.05 mins</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 3,000 x 2</span>
<span class="co">#&gt;    u_id     data                </span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;list&gt;              </span>
<span class="co">#&gt;  1 26295661 &lt;tibble [406 × 8]&gt;  </span>
<span class="co">#&gt;  2 69400017 &lt;tibble [79 × 8]&gt;   </span>
<span class="co">#&gt;  3 16294855 &lt;tibble [5,889 × 8]&gt;</span>
<span class="co">#&gt;  4 40275983 &lt;tibble [67 × 8]&gt;   </span>
<span class="co">#&gt;  5 91759535 &lt;tibble [1,823 × 8]&gt;</span>
<span class="co">#&gt;  6 81298067 &lt;tibble [191 × 8]&gt;  </span>
<span class="co">#&gt;  7 45267153 &lt;tibble [57 × 8]&gt;   </span>
<span class="co">#&gt;  8 37588593 &lt;tibble [4,475 × 8]&gt;</span>
<span class="co">#&gt;  9 81235774 &lt;tibble [335 × 8]&gt;  </span>
<span class="co">#&gt; 10 67861300 &lt;tibble [29 × 8]&gt;   </span>
<span class="co">#&gt; # … with 2,990 more rows</span></pre></div>
</div>
<div id="use-built-in-recipes" class="section level3">
<h3 class="hasAnchor">
<a href="#use-built-in-recipes" class="anchor"></a>Use built-in recipes</h3>
<p>Current available recipes, where <code>HMLC</code> is the default recipe used in <code>identify_location</code>:</p>
<ul>
<li>
<code>HMLC</code>:
<ul>
<li>Weighs data points across multiple time frames to ‘score’ potentially meaningful locations for each user</li>
</ul>
</li>
<li>
<code>FREQ</code>
<ul>
<li>Selects the most frequently ‘visited’ location assuming a user is active mainly around their home location.</li>
</ul>
</li>
<li>
<code>OSNA</code>: <a href="https://www.researchgate.net/publication/279884727_Identification_of_Key_Locations_based_on_Online_Social_Network_Activity">Efstathiades et al.2015</a>
<ul>
<li>Finds the most ‘popular’ location during ‘rest’, ‘active’ and ‘leisure time. Here we focus on ’rest’ and ‘leisure’ time to find the most possible home location for each user.</li>
</ul>
</li>
<li>
<code>APDM</code>: <a href="https://www.researchgate.net/publication/233197970_Using_Mobile_Positioning_Data_to_Model_Locations_Meaningful_to_Users_of_Mobile_Phones">Ahas et al. 2010</a>
<ul>
<li>Calculates the average and standard deviation of start time data points by a single user, in a single location.</li>
</ul>
</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb6"><pre class="r"><span class="co"># default recipe: homelocator -- HMLC</span>
<span class="fu"><a href="reference/identify_location.html">identify_location</a></span>(<span class="no">test_sample</span>, <span class="kw">user</span> <span class="kw">=</span> <span class="st">"u_id"</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>,
                  <span class="kw">location</span> <span class="kw">=</span> <span class="st">"grid_id"</span>, <span class="kw">show_n_loc</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">recipe</span> <span class="kw">=</span> <span class="st">"HMLC"</span>)


<span class="co"># recipe: Frequency -- FREQ</span>
<span class="fu"><a href="reference/identify_location.html">identify_location</a></span>(<span class="no">test_sample</span>, <span class="kw">user</span> <span class="kw">=</span> <span class="st">"u_id"</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>,
                  <span class="kw">location</span> <span class="kw">=</span> <span class="st">"grid_id"</span>, <span class="kw">show_n_loc</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">recipe</span> <span class="kw">=</span> <span class="st">"FREQ"</span>)


<span class="co"># recipe: Online Social Network Activity -- OSNA</span>
<span class="fu"><a href="reference/identify_location.html">identify_location</a></span>(<span class="no">test_sample</span>, <span class="kw">user</span> <span class="kw">=</span> <span class="st">"u_id"</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>,
                  <span class="kw">location</span> <span class="kw">=</span> <span class="st">"grid_id"</span>, <span class="kw">show_n_loc</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">recipe</span> <span class="kw">=</span> <span class="st">"OSNA"</span>)


<span class="co"># recipe: Online Social Network Activity -- APDM</span>
<span class="co">## APDM recipe strictly returns the most likely home location</span>
<span class="co">## It is important to load the neighbors table before you use the recipe!!</span>
<span class="co">## example: st_queen &lt;- function(a, b = a) st_relate(a, b, pattern = "F***T****")</span>
<span class="co">##          neighbors &lt;- st_queen(df_sf) ===&gt; convert result to dataframe </span>

<span class="no">df_neighbors</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="fu">here</span>(<span class="st">"data/neighbors.rds"</span>))
<span class="fu"><a href="reference/identify_location.html">identify_location</a></span>(<span class="no">test_sample</span>, <span class="kw">user</span> <span class="kw">=</span> <span class="st">"u_id"</span>, <span class="kw">timestamp</span> <span class="kw">=</span> <span class="st">"created_at"</span>,
                  <span class="kw">location</span> <span class="kw">=</span> <span class="st">"grid_id"</span>, <span class="kw">recipe</span> <span class="kw">=</span> <span class="st">"APDM"</span>)</pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/spatialnetworkslab/homelocator/">https://​github.com/​spatialnetworkslab/​homelocator/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/spatialnetworkslab/homelocator/issues">https://​github.com/​spatialnetworkslab/​homelocator/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Qingqing Chen <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ate Poorthuis <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Qingqing Chen, Ate Poorthuis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
