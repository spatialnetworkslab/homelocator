---
title: "Efstathiades Method"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output: 
  html_document:
    toc: true 
    toc_depth: 4  
    number_sections: true  
    theme: united  
    highlight: tango  
    toc_float: true   
    code_folding: hide
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r load_library, message=FALSE, warning=FALSE}
library(tidyverse)
library(magrittr)
library(sf)
library(lubridate)
library(furrr)
library(gridExtra)
source("function_Efstathiades.R")
```

# Load data
```{r load_data, message=FALSE, warning=FALSE}
df <- read_data("lexington-with-GEOID-2012-2017.csv")
```

# Date cleanning 
```{r data_cleanning, message=FALSE, warning=FALSE}
df_sub <- df %>% 
  remove_tooLowUsers() %>% 
  remove_tooHighUsers() %>% 
  remove_weekendAct()
```

# Key location identification model 
```{r work_location, message=FALSE, warning=FALSE}
## Work location 
work_loc <- identify_workloc(df_sub)
#write_csv(work_loc, path = "/Users/qingqing/Dropbox/SUTD/Ate/homelocator/comparison/result_efstathiades_workloc.csv")
## Home location 
home_loc <- identify_homeloc(df_sub)
#write_csv(home_loc, path = "/Users/qingqing/Dropbox/SUTD/Ate/homelocator/comparison/result_efstathiades_homeloc.csv")
```


- Tweets sent during different hours of the day by different day of week 
```{r tweets_visual_overtime, message=FALSE, warning=FALSE}
visualize_data(df)
```






















